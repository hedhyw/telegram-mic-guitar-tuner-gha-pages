(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[375],{7013:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/Tuner",function(){return i(1883)}])},4972:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return u}});var t=i(5893),r=i(5989),a=i(1542),s=i(6486),o=i.n(s),d=i(5241),c=i.n(d),l=i(4362);function u(e){let n,i,{notes:s,frequency:d}=e;if(!s)return(0,t.jsx)("div",{children:"Notes are not specified."});let u=o().minBy(s,e=>Math.abs(e.difference(d)))||s[0],_=-u.difference(d),h=60>Math.abs(_)&&d>30,f=(n=_/60,h?n>1&&(n=1):n=0,n*=360),m=(i="Pull any guitar string",h&&_>=2&&(i="Tune down"),h&&_<=-2&&(i="Tune up"),h&&2>Math.abs(_)&&(i="Good!"),i),p=h?u.name:(0,t.jsx)(l.Z,{fontSize:"inherit"}),w=(e,n)=>e.addEventListener("transitionend",n,!1);return(0,t.jsxs)("div",{className:c().indicator,children:[(0,t.jsxs)("div",{className:c().indicatorMain,children:[(0,t.jsx)("div",{className:c().indicatorArrowDown}),(0,t.jsx)("div",{className:c().indicatorCircle,style:{rotate:"".concat(f+-18,"deg")}}),(0,t.jsx)("div",{className:c().indicatorText,children:(0,t.jsx)(r.Z,{mode:"out-in",children:(0,t.jsx)(a.Z,{addEndListener:w,classNames:"fade",children:(0,t.jsx)("p",{className:h?"":c().noteUnknown,children:p})},p)})})]}),(0,t.jsx)("div",{className:c().indicatorHint,children:(0,t.jsx)(r.Z,{mode:"out-in",children:(0,t.jsx)(a.Z,{addEndListener:w,classNames:"fade",children:(0,t.jsx)("p",{children:m})},m)})})]})}},1883:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return u}});var t=i(5893),r=i(7294),a=i(4972),s=i(2173),o=i(1543),d=i(7315),c=i.n(d);class l{get name(){return this._name}difference(e){return this._frequency-e}constructor(e,n){this._frequency=n,this._name=e}}class u extends r.Component{render(){return(0,t.jsxs)("div",{children:[!this.state.permissionGranted&&(0,t.jsxs)("div",{className:c(),children:[(0,t.jsx)("p",{className:c().warningIcon,children:(0,t.jsx)(s.Z,{fontSize:"inherit"})}),(0,t.jsxs)("p",{className:c().warningText,children:["Unable to access the microphone.",(0,t.jsx)("br",{}),"Please try the application from another device or reload the page."]})]}),this.state.permissionGranted&&this.state.frequency!==1/0&&(0,t.jsx)(a.default,{frequency:this.state.frequency,notes:this._notes})]})}_setFrequency(e){this.setState({frequency:Math.round(e)})}_setPermissionDenied(){this.setState({permissionGranted:!1})}componentDidMount(){var e,n,i,t,r;navigator.getUserMedia=(null===(e=navigator)||void 0===e?void 0:e.getUserMedia)||(null===(n=navigator)||void 0===n?void 0:n.webkitGetUserMedia)||(null===(i=navigator)||void 0===i?void 0:i.mozGetUserMedia),(null===(t=navigator)||void 0===t?void 0:t.getUserMedia)?null===(r=navigator)||void 0===r||r.getUserMedia({video:!1,audio:!0},e=>this._audioCallback(e),e=>{this._setPermissionDenied(),console.error(e)}):this._setPermissionDenied()}_audioCallback(e){let n=new AudioContext,i=n.createMediaStreamSource(e),t=n.createAnalyser();i.connect(t);let r=o.X.forFloat32Array(t.fftSize),a=new Float32Array(r.inputLength);this._play=()=>{t.getFloatTimeDomainData(a);let[e,i]=r.findPitch(a,n.sampleRate);i>.8&&this._setFrequency(e),console.debug(e,i),setTimeout(this._play,250)},this._play()}componentWillUnmount(){this._play=()=>{}}constructor(e){super(e),this.state={frequency:1/0,permissionGranted:!0},this._notes=[new l("e4",329.63),new l("B3",246.94),new l("G3",196),new l("D3",146.83),new l("A2",110),new l("E2",82.41)]}}},5241:function(e){e.exports={indicator:"Indicator_indicator__d3oYs",indicatorMain:"Indicator_indicatorMain__5zS2_",indicatorCircle:"Indicator_indicatorCircle__fpe7A",indicatorArrowDown:"Indicator_indicatorArrowDown__Nj0zM",indicatorText:"Indicator_indicatorText__64Qsr",indicatorHint:"Indicator_indicatorHint__G51ug",noteUnknown:"Indicator_noteUnknown__g0uhc"}},7315:function(e){e.exports={warningText:"Tuner_warningText__2joCu",warningIcon:"Tuner_warningIcon__dEQTA"}}},function(e){e.O(0,[662,718,716,774,888,179],function(){return e(e.s=7013)}),_N_E=e.O()}]);